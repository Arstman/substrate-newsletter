# 2023.10 - Substrate 技术更新速递

## 重要提交和发布

1. [为`pallet-tips`增加`MaxTipAmount`的最大补贴金额常量](https://github.com/paritytech/polkadot-sdk/pull/1709)  2023年9月第三周，波卡网络遭到了一次针对治理模块的攻击，攻击虽然因为`pallet-fragment-election`模块的即时刷新成员机制而没有造成损失，但开发团队发现由于没有设置最大补贴金额，导致攻击者如果经过长时间精心准备，有可能会在一定程度掌控议会选票的情况下， 发出超高额度的津贴； 因此本次PR通过增加最大补贴金额常量`MaxTipAmount`于`pallet-tips`模块中， 该值类型为`ConstU128`, 并在补贴发放中添加限制条件函数。

2. [`pallet-balances`模块添加冻结理由`RuntimeFreezeReasons`，并确保其为一个枚举类型](https://github.com/paritytech/polkadot-sdk/pull/1900)：`pallet-balances`模块的配置中添加一项名为`RuntimeFreezeReasons` 的模块，并使用`trait VariantCount`来确保其为一个枚举类型， 该`trait` 用于暂时替代Rust语言目前还没有稳定的[`variant_count`](https://doc.rust-lang.org/std/mem/fn.variant_count.html) API, 来确保其实现者是一个枚举。 这个值仅用于检查与`MaxFreezeMaxHolds`  进行对比， 一般来说开发者需要尽量在配置对其设置真实值，当然设置为`()`值也是可以的。

3. [NFT模块增加item通过`Ispect`读取集合属性功能](https://github.com/paritytech/polkadot-sdk/pull/1914) 这个 PR 的作用是解决 `pallet_nfts` 的 `nonfungibles_v2`版本的`Inspect`  和 `Mutate` 两个`trait`时因命名空间值不同而导致无法相互访问的问题： 当使用 `<Nfts as Mutate>::set_collection_attribute()` 设置集合属性后，就无法使用 `<Nfts as Inspect>::collection_attribute()` 来读取，因这两者使用不同的命名空间值——即在设置属性时是`AttributeNamespace::Pallet` 命名空间，而读取时则是 `AttributeNamespace::CollectionOwner`; 这就导致了集合的属性一旦设定，之后就无法读取。 该 PR 旨在调整命名空间值，以使设置和读取属性时使用相同的命名空间，由此可以给到`item` 一个可选的 `Inspect::system_attribute()` 参数来读取其所在集合的属性。并在`NftsApi::system_attribute()`函数中相应增加一个类型为`Option<u32>`的 `item`参数。 这样的改动意味者API也需要相应改动，建议开发者follow.

4. [新增Polkadot Cloud云托管项目](https://github.com/paritytech/polkadot-cloud)：Polkadot Cloud是波卡官方最新增加的SaaS服务项目，用于提供开发和发布并托管Polkadot dapp 平台, 目前该项目正在早期开发阶段。


## 设计方案和问题讨论

1. [AURA共识增加模糊报告系统](https://github.com/paritytech/polkadot-sdk/pull/1766)：`equivocation report` 模糊报告，是指当某个节点检测到共识机制产生相同高度的区块时发出的信号，在`BABE`、`GRANPA`中有对其实现防御机制， 此PR借鉴该实现机制， 为` AURA`共识也添加针对性的`offence report system`防御报告机制，其核心是添加`equivocations.rs`子模块到`AURA`模块中， 提供以下功能：
    - 一个实现`Offence`trait的` EquivocationOffence`结构，用于指示`AURA`共识中的模糊状态
    - 一个对上叙状态发生后的报告机制
    - 提供基于此的签名和提交事务
    - 一个获取当前区块授权方法
    - 一个证明当前会话授权的所有权签证系统机制
该方案如果通过，将对共识安全性有相当大的提升，并将对跨链共识产生较大变更。

## 文档和资料

1. [ink-docs](https://github.com/paritytech/ink-docs/pull/282/files)：增加如何将`ink!`河源迁移到平行链Runtime的文档。 

2. [Polkadot Parachain主机实施者指南](https://paritytech.github.io/polkadot-sdk/book/index.html):  本文档旨在提供实施 Polkadot 的平行链功能主机的部署、功能和实现方式。宿主机Host是提供平行链的安全性和进展的软件。本文档不是为特定平行链的实施者编写的，而是为 Parachain Host 的实施者编写的； 也是目前唯一一个对Polkadot 特定实例研究的资料，其中包括底层技术细节和软件架构的文档。

## 技术生态和社区

1. [第13期substrate入门课报名](https://meggd.xet.tech/s/1O671J) 由Oneblock和Parity联合举办的《Substrate区块链开发入门》第十三期预计在2023年10月正式开课！入门课程是进阶课程的基础, 带你快速入门Substrate框架，从0到1迈入区块链开发，通过学习本门课程，同学们可以了解到区块链的基本概念，熟悉Substrate的基本作用，真正完成“入门"，切身参与到区块链的世界。名额有限，报名从速！

2. [开启 Web3 探险征程！新一期 Polkadot Blockchain Academy 等你加入](https://mp.weixin.qq.com/s/4DGcg3XdSrWUc5zrNApBew)：成立于 2022 年的 Polkadot Blockchain Academy（简称 PBA）是由波卡成立的一个深入的、开创性的区块链课程，致力于帮助 Web3 创新者和未来的顶级编程人员实现他们的想法和抱负。该区块链学院由波卡创始人 Gavin Wood 创立，由来自 Polkadot 生态、Parity Technologies 和 Web3 基金会的顶尖工程师运营。这是一门为期一个月的开创性课程，能够为开发工程师们提供构建区块链所需的各种知识。当期项目结束后，如成功毕业，学员将获得 PBA 的毕业证书，并有机会申请 Parity Technologies 以及波卡生态中的工作。

3. [Polkadot 将参加新加坡 TOKEN2049](https://mp.weixin.qq.com/s/sKZOZUJo0bpgaKwi2VQRqg): 9 月 13 日至 14 日，Polkadot 生态系统将在 TOKEN2049 上再次齐聚。如果您有兴趣了解 Polkadot 生态系统中新构建者可用的先进技术、入职资源和融资机会，不要错过这个与 Polkadot 专家进行一对一会议的机会 。Polkadot Connect 是 TOKEN2049 期间的一项社交活动，您将有机会在温馨、轻松的氛围中与 Web3 先驱者和关键决策者互动。

4. [著名电子音乐平台 Beatport 在 Polkadot 上推出 NFT 市场！](https://mp.weixin.qq.com/s/qTB_BaFoT-osCN82ns6sOA): Beatport，一个广受 DJ 和音乐人欢迎的标志性音乐平台，终于在 Web3 领域展示了自己的影响力。他们正在推出一个名为 Beatport.io 的新市场，这是在 Aventus 平行链上建立的，而 Aventus 则基于 Polkadot 网络。Beatport.io 不仅在传统意义上的音乐方面独具特色，还在各种 NFT 艺术作品中加入了电子音乐元素，这被公司的高级副总裁 Ed Hill 称为 “Music+”。与 OpenSea 这样的 NFT 市场相似，Beatport.io 也提供购买、出售和交易 NFT 的功能，但它的主要侧重点是电子音乐。

5. [ISMP: 一种轻量级的传输协议](https://blog.polytope.technology/the-interoperable-state-machine-protocol): Polytope Labs 宣布发布 ISMP，这是一种轻量级的传输协议，允许通过 HTTP 样式的 GET/POST 请求在区块链之间实现无需信任的互操作性。

6. [Polkadot 技术如何塑造去中心化未来](https://link.chtbl.com/ANBVUi0x) Web3 基金会的技术教育和 Grant 负责人 Bill 在 Web3 Labs 的最新博客中分享了 Polkadot 技术如何塑造去中心化未来，以及 Polkadot 最新上线的 OpenGov 治理系统。

7. [开发者必看！Parity 将 Cumulus、Substrate 和 Polkadot 存储库合并为 Polkadot SDK！](https://mp.weixin.qq.com/s/wFk_FNLwlME6j1Svw9K_7A) Parity 的工程团队将把 Cumulus、Substrate 和 Polkadot 的代码库合并为一个名为 Polkadot SDK 的存储库。现在，由于所有代码都在一个地方，只需要一个 PR。减少复杂性、改善团队协作和提高项目管理效率。如果你在本地机器上有旧存储库的克隆，那么在存储库合并后，你可能需要更新或重新克隆新的合并存储库，以确保你的本地版本与新的单一仓库保持同步。

8. [特斯拉和捷豹将在全球最大车展使用 Polkadot 平行链 peaq 的技术进行支付充电和停车费的演示！](https://mp.weixin.qq.com/s/51qh9ayERRfXKyIovHwSbg) 今年 9 月份在德国慕尼黑的 IAA MOBILITY 2023，届时 peaq 将作为 L1底层架构参与特斯拉和捷豹汽车的现场演示。演示将涉及两辆电动汽车：一辆特斯拉和一辆捷豹，一个充电站和一个智能停车位。访客将有机会短暂驾驶其中一辆电动车，使用充电器，并将车停好。作为这一过程的一部分，汽车将使用其自主机器身份（Self-Sovereign Machine Identity）与充电站或停车位进行注册。它还将从自己的去中心化钱包中支付充电或停车费用。peaq 的测试网和基于 Cosmos SDK 的 Fetch 网络将负责支持这些互动，作为交易和身份层。换句话说，它将作为设备之间可以识别彼此和进行价值交换的数字骨干。peaq 还提供了一个去中心化应用，使电动车能进行点对点充电。



## 跨链协议

1. [`NetworkExportTable` 和 `xcm-builder`的一些改进](https://github.com/paritytech/polkadot-sdk/pull/1848) 此PR主要提出了以下改进：
    - 当前的实现在远程位置过滤方面缺乏除查找之外的支持，为了提供更多的控制和细粒度，允许配置在桥接到不同共识时限制访问，例如特定的远程平行链。
    - 一些被活跃使用的辅助函数, 如`StartsWith`, `StartsWithExplicitGlobalConsensus`等被移动到相应模块中，以便更好地组织代码。
    - 添加了一个新的过滤器，用于启用基于位置和资产的过滤。这个过滤器用来配置 `XcmTeleportFilter`  和 `XcmReserveTransferFilter` ， 对于限制特定资产非常有用。


2. [讨论是否废弃`pallet-xcm`中的`sent`和`execute`方法](https://github.com/paritytech/polkadot-sdk/pull/1798)：此PR主要是试图废弃原有的`sent`和`execute`方法，用`sent_blob`和`execute_blob`来取代； 其主要变化是引入了一个`max_weight`常数，用于指示消息 msg 是否能够完全执行或仅部分执行，在尝试执行过程中，最多会使用 max_weight 的权重。如果 max_weight 小于消息执行所需的最大权重，则不会尝试执行； 而如果在发送或者执行中， 每一指令都会消耗相应权重，直到消耗的权重到达`max_weight`定义的值为止，所带来的结果是今后跨链消息收到成功执行的返回时，并不意味着 msg 被成功完整执行，只表示其中的一部分被执行了。

