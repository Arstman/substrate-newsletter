# 2025.05 - Substrate 技术更新速递

---

## 重要提交和发布

### 1. Revive 模块存储计量器机制简化

Polkadot-SDK 团队合并了一个重要的智能合约基础设施更新，简化了 Revive 模块的存储计量器（storage meter）机制 [PR #8667](https://github.com/paritytech/polkadot-sdk/pull/8667)。主要更新包括：

- 将存储押金限制与原始账户余额完全解耦，使嵌套计量器的限制推理更加清晰
- 统一使用 `StorageDepositNotEnoughFunds`（余额不足）和 `StorageDepositLimitExhausted`（限制已用尽）错误类型
- 改进了新账户创建时的错误处理机制，将 ED（Existential Deposit）支付失败从 `TransferFailed` 返回码改为 `StorageDepositNotEnoughFunds` 并直接 trap 调用者
- 移除了不再必要的存储押金限制检查代码

这个更新解决了历史遗留的设计复杂性问题。之前为了确保在不可失败上下文中进行存储押金收集，系统将押金限制与原始账户余额耦合，导致代码逻辑复杂。随着押金收集机制改为可失败模式，这种耦合设计不再必要。新的设计使得根存储计量器和所有嵌套计量器的限制完全独立于原始账户余额，大幅简化了系统架构。

值得注意的是，这个更新还改善了合约的错误处理体验。由于系统对合约隐藏了 ED 的概念，相关的错误也不应该作为合约必须处理的错误代码出现。这一改进为后续的合约功能增强奠定了基础。

### 2. LiteP2P 网络层修复保留节点模式连接控制

Polkadot-SDK 团队合并了一个重要的网络层错误修复，修复了 LiteP2P 通知 peerset 在保留节点模式下的连接控制问题 [PR #8650](https://github.com/paritytech/polkadot-sdk/pull/8650)。主要更新包括：

- 修复了在 reserved-only 模式下接受非保留节点入站连接的问题
- 改进了 `report_inbound_substream` 函数，现在会在 reserved-only 状态下正确拒绝非保留节点
- 实现了更严格的节点状态管理，防止在 `Disconnected` 或 `Backoff` 状态下推进节点状态
- 将被拒绝连接的打开状态正确设置为 `Cancelled`
- 增强了 `report_substream_opened` 函数对 `Disconnected` 状态的鲁棒性处理
- 添加了 `reserved_only_rejects_non_reserved_peers` 测试确保修复有效性

这个修复解决了一个重要的网络安全问题。之前，LiteP2P 在接受入站连接时完全忽略了 reserved-only 状态，虽然在槽位分配阶段能正确处理，但仍然允许非保留节点建立初始连接。修复后，系统会在连接建立阶段就拒绝非保留节点，并向 LiteP2P 发送 `Rejected` 响应，确保后续不会为被拒绝的节点打开子流。

值得注意的是，这个修复还提高了代码的一致性和模糊测试的鲁棒性。通过将 panic 替换为 `debug_assert` 并添加即时拒绝机制，系统在面对异常状态时更加稳定。这个更新已在 Kusama 和 Polkadot 网络上使用 LiteP2P 进行了测试验证。

### 3. 选举提供者系统重复解决方案问题修复与远程挖矿支持

Polkadot-SDK 团队合并了一个重要的选举系统更新，修复了选举提供者多区块（EPMB）重复解决方案问题并为选举提供者多阶段（EPM）添加了远程挖矿设备支持 [PR #8585](https://github.com/paritytech/polkadot-sdk/pull/8585)。主要更新包括：

- 修复了 EPMB（Election Provider Multi-Block）中的解决方案重复提交问题
- 为 EPM（Election Provider Multi-Phase）添加了远程挖矿设备框架
- 实现了新的重复检测机制，确保选举解决方案的唯一性
- 添加了特性门控（feature-gate）支持，允许可选的远程挖矿功能
- 增强了测试套件，包括针对 Polkadot 和 Kusama 网络的验证测试
- 改进了选举算法的稳定性和可靠性

这个更新解决了影响网络选举过程的关键问题。EPMB 重复解决方案问题可能导致验证人选举过程中出现冗余计算和资源浪费，影响网络效率。修复后，系统能够有效识别和防止重复解决方案的提交，确保选举过程的高效运行。

远程挖矿设备的添加为 EPM 系统提供了新的灵活性。这个功能允许选举解决方案的计算可以分布式进行，提高了系统的可扩展性和容错能力。值得注意的是，这个功能通过特性门控实现，确保了向后兼容性和可选部署。

这个更新已经从正在开发的 [PR #8422](https://github.com/paritytech/polkadot-sdk/pull/8422) 中提前回移到主分支，并已向后移植到多个稳定版本（stable2412、stable2503），确保当前维护的版本都能受益于这些改进。通过在 Polkadot 和 Kusama 网络上的实际测试验证，确保了修复的有效性和稳定性。

### 4. Fork-Aware 交易池轻量模式回退机制优化

Polkadot-SDK 团队合并了一个重要的交易池基础设施改进，为 Fork-Aware 交易池（fatxpool）的轻量模式添加了回退机制 [PR #8533](https://github.com/paritytech/polkadot-sdk/pull/8533)。主要更新包括：

- 为 `ready_at_light` 功能添加了智能回退机制，解决特定场景下就绪交易集合为空的问题
- 改进了分叉链场景下的区块提议过程，确保始终有可用的交易集合
- 实现了最新视图交易的回退策略，即使在父区块未通知给交易池的情况下也能正常工作
- 增强了交易池在复杂网络拓扑中的鲁棒性和可靠性
- 更新了相关测试套件，确保新的回退机制正常运行
- 优化了交易选择逻辑，提高了区块生产的连续性

这个更新解决了区块提议过程中的一个关键问题。当基于分叉链上的父区块建立新区块时，如果该分叉链没有向交易池通知最佳区块，提议者依赖 `ready_at_light` 时可能面临空的就绪交易集合，导致无法有效生成包含交易的区块。新的回退机制通过使用交易池最新视图中的就绪交易来解决这个问题。

值得注意的是，回退机制会考虑最新处理视图中的交易，即使这些交易在当前上下文中可能无效。这种设计权衡了可用性和准确性，确保区块生产过程的连续性。这个改进特别有益于轻客户端和复杂网络环境，显著提升了交易池在各种网络条件下的表现。

这个更新关闭了两个长期存在的问题（[#8213](https://github.com/paritytech/polkadot-sdk/issues/8213) 和 [#6056](https://github.com/paritytech/polkadot-sdk/issues/6056)），展示了团队在持续改进核心基础设施方面的努力。

### 5. 声明分发系统状态获取异常处理机制优化

Polkadot-SDK 团队合并了一个重要的网络稳定性修复，改进了声明分发（statement-distribution）系统在无法获取状态时的处理机制 [PR #8510](https://github.com/paritytech/polkadot-sdk/pull/8510)。主要更新包括：

- 修复了在争议事件期间声明分发系统因无法获取已丢弃叶子状态而导致的处理中断问题
- 改进了错误处理逻辑，跳过无法获取状态的叶子而非硬失败退出
- 优化了分叉场景下的状态查询机制，提高系统在复杂网络拓扑中的鲁棒性
- 解决了运行时 API 缓存在争议风暴期间被驱逐导致的状态查询失败
- 增强了 backing 过程的连续性，确保基于有效叶子的候选者能够正常被支持
- 改进了禁用验证者获取逻辑的容错能力

这个修复解决了在 Polkadot 和 Kusama 网络争议事件中观察到的关键问题。当网络存在大量争议时，backing 过程会出现延迟，原因是声明分发系统试图为已被状态修剪丢弃的分叉叶子获取禁用验证者信息。由于这些叶子的状态已不可用，请求会失败并导致整个处理流程中断。

问题的根本原因在于隐式视图逻辑会返回所有可能的中继父块，包括那些状态已被丢弃的分叉叶子。之前的逻辑在遇到第一个获取错误时就会退出，导致基于该叶子的候选者无法被正常支持。新的逻辑通过跳过有问题的叶子而继续处理其他有效叶子，确保了系统的连续运行。

值得注意的是，这个问题在正常情况下并不明显，因为运行时 API 缓存通常能够提供所需信息。但在争议风暴期间，缓存中的条目会被驱逐，导致对已丢弃状态的查询失败。这个修复已经向后移植到 stable2503 版本，确保生产网络能够及时受益于这一改进。

### 6. Substrate RPC 合约地址生成逻辑修复

Polkadot-SDK 团队合并了一个重要的智能合约基础设施修复，解决了 Substrate RPC 运行时调用返回的合约地址不一致问题 [PR #8504](https://github.com/paritytech/polkadot-sdk/pull/8504)。主要更新包括：

- 修复了干运行（dry-run）合约部署与实际交易部署地址不匹配的问题
- 改进了 `create1` 地址推导逻辑，正确处理不同执行上下文中的 nonce 计算
- 添加了 `IncrementOnce` 执行上下文检查，确保地址推导的一致性
- 实现了更精确的 nonce 处理机制，区分预调度增量和干运行场景
- 增强了相关测试套件，验证不同执行上下文下的地址生成逻辑
- 确保用户可以依赖干运行返回的地址来匹配实际提交时的地址

这个修复解决了一个影响开发者体验的关键问题。之前，当通过运行时 API 进行合约部署干运行时，返回的地址是基于当前 nonce N 推导的，而实际交易执行时由于 nonce 在预调度阶段已被增量，合约实际创建在基于 nonce N-1 推导的地址上，导致地址不一致。

问题的根源在于地址推导逻辑没有正确区分交易执行和干运行执行上下文。修复通过添加对 `IncrementOnce::AlreadyIncremented` 状态的检查，确保只有在实际交易执行（nonce 已增量）时才从账户 nonce 中减 1，而在干运行时使用原始 nonce 值。这样确保了无论在哪种执行上下文中，都能生成一致的合约地址。

值得注意的是，这个修复关闭了长期存在的问题 [contract-issues#37](https://github.com/paritytech/contract-issues/issues/37)，显著改善了合约开发和部署的用户体验。该更新后来被临时回滚以进行进一步优化，展示了团队在确保代码质量方面的严格态度。

### 7. 交易池解锁集合移除逻辑修复

Polkadot-SDK 团队合并了一个重要的交易池内部逻辑修复，解决了交易子树移除时解锁集合处理不当的问题 [PR #8500](https://github.com/paritytech/polkadot-sdk/pull/8500)。主要更新包括：

- 修复了移除交易子树时部分交易未从其他交易的解锁集合中正确移除的逻辑缺陷
- 改进了交易图模块中解锁集合的维护机制，确保数据结构的一致性
- 实现了更精确的依赖关系清理逻辑，防止遗留的无效引用
- 增强了交易移除过程的完整性，确保所有相关数据结构的同步更新
- 添加了专门的单元测试验证修复的有效性
- 通过重负载测试（500万交易）验证了修复的稳定性

这个修复解决了交易池图模块中的一个技术债务问题。当移除交易子树时，系统需要同时从其他交易的解锁集合中移除相关引用，但之前的逻辑存在不完整的清理机制。虽然这个问题没有造成用户可见的功能影响或ready集合迭代器的有效性问题，但逻辑上的不一致可能在特定场景下导致内存使用不当或数据结构污染。

问题的根源在于交易依赖图的复杂性管理。当一个交易被移除时，所有依赖于它的交易都需要更新其解锁集合，但之前的实现在处理深层嵌套的依赖关系时存在遗漏。新的逻辑确保了递归清理过程的完整性，维护了交易池内部数据结构的一致性。

值得注意的是，虽然这个修复没有改变交易池的外部行为，但它提高了系统的内部健壮性和代码质量。修复关闭了问题 [#8498](https://github.com/paritytech/polkadot-sdk/issues/8498)，展示了团队在持续改进代码质量和消除技术债务方面的努力。通过大规模负载测试的验证，确保了修复不会引入新的问题。

### 8. VMP 路由中 XCM 消息大小验证功能增强

Polkadot-SDK 团队合并了一个重要的跨链消息基础设施改进，为 VMP（Vertical Message Passing）路由添加了 XCM 消息大小验证功能 [PR #8409](https://github.com/paritytech/polkadot-sdk/pull/8409)。主要更新包括：

- 为 UMP（Upward Message Passing）路径添加了消息大小验证，修复了之前 `validate` 函数未检查消息大小的问题
- 实现了 `ParentAsUmp` 路由器中的消息大小限制检查机制
- 为资产中心迁移（AHM）项目中的大数据载荷传输提供基础支持
- 增强了 XCM 路由的鲁棒性，防止超大消息导致的网络问题
- 添加了相应的单元测试验证消息大小验证功能
- 为后续的递归消息分割功能奠定基础

这个更新解决了跨链消息处理中的一个重要遗漏。在资产中心迁移项目中，资产中心和中继链需要传输大量数据载荷，如每个会话的1000个验证者密钥和相应的奖励点数。虽然当前 Polkadot 和 Kusama 的限制允许此类载荷，但之前在平行链到中继链的 UMP 路径中，`SendXcm::validate` 实际上并未检查消息大小。

问题的背景是确保 XCM 消息在发送前能够正确验证大小限制。当消息过大时，系统应该能够检测到 `MessageSizeExceeded` 错误并采取相应措施（如递归分割消息）。修复通过在 `ParentAsUmp` 路由器中添加消息大小检查，确保了 UMP 路径与 DMP（Downward Message Passing）路径一致的验证行为。

值得注意的是，这个修复主要针对 UMP 路径，因为 DMP 路径（中继链到平行链）已经具有适当的消息大小验证机制。这个基础设施改进为即将到来的消息分割功能提供了必要的验证层，确保大型跨链数据传输的可靠性和效率。该更新已通过 Zombienet 实验验证，证实了修复的有效性。

### 9. Pallet-Bounties 押金调整功能增强

Polkadot-SDK 团队合并了一个重要的治理功能改进，为 pallet-bounties 添加了押金调整机制 [PR #8382](https://github.com/paritytech/polkadot-sdk/pull/8382)。主要更新包括：

- 添加了新的外部调用 `poke_deposit`，用于重新调整创建赏金时的押金数额
- 实现了智能费用机制，当实际调整押金时调用免费，否则需要支付费用
- 引入了新事件 `DepositPoked`，在成功执行押金调整时发出
- 设计了灵活的押金调整逻辑，支持押金的增加或减少操作
- 添加了全面的测试套件，覆盖各种押金调整场景
- 实现了完整的基准测试，确保性能符合预期

这个更新是资产中心迁移（AHM）项目的重要组成部分，解决了押金重新考虑的需求。在资产中心迁移后，某些赏金的押金要求可能会发生变化，需要能够调整之前创建的赏金押金。虽然该功能的直接用途是在 AH 迁移后退还部分押金，但其通用设计使其能够处理各种押金调整场景。

问题的背景源于长期存在的需求（[#5591](https://github.com/paritytech/polkadot-sdk/issues/5591)）。当网络参数或经济模型发生变化时，需要能够调整已存在的押金以反映新的要求。新的 `poke_deposit` 外部调用通过检查当前押金与所需押金的差异，自动执行适当的调整操作。

值得注意的是，这个功能采用了用户友好的费用结构设计。只有在实际进行押金调整时，调用才是免费的，这激励了有效的押金维护行为。当没有需要调整的押金时，调用者需要支付费用，防止了无意义的系统调用。这个设计平衡了功能的实用性和网络资源的保护，展示了 Polkadot 治理机制的持续演进。


## 设计方案和问题讨论

### 1. Revive API 只读调用 Origin 要求优化讨论

   Polkadot-SDK 团队收到了一项关于优化 Revive 智能合约平台 API 设计的提案 [Issue #8619](https://github.com/paritytech/polkadot-sdk/issues/8619)，重点关注只读合约调用时不必要的 origin 映射要求。主要讨论点包括：

   - `ReviveApi.call` 函数要求 origin 参数必须是已映射到 H160 地址的账户
   - 对于只进行读操作且不关心调用者身份的合约调用，这个要求显得过于严格
   - 用户和库开发者必须显式创建和提供映射账户才能读取合约数据
   - 影响了开发者体验和库的易用性

   问题的根源：
   - Revive 引入了账户映射机制，要求 AccountId 与 H160 地址之间建立映射关系
   - 之前可以传入任意地址（如合约地址本身）进行调用
   - 现在传入未映射账户会导致 AccountUnmapped 错误
   - 对于纯读取操作，强制要求映射账户增加了不必要的复杂性

   解决方案讨论：
   - **库侧解决方案**：@chungquantin 建议在客户端库层面处理映射，而不是修改运行时模块接口，认为这样更简单且避免了运行时逻辑复杂化
   - **运行时优化方案**：@tien 主张应该允许跳过 origin 映射要求，特别是对于不需要身份验证的只读调用
   - **实用性解决方案**：@athei 提供了实际可行的解决方案，指出可以使用任何最后12字节为 `0xEE` 的地址，这样的地址无需映射即可使用

   技术实现细节：
   - 只有非 H160 派生的账户才需要显式映射
   - 形如 `0xeth_address++"0XEE"x12` 的账户可以直接使用
   - 这种特殊格式为 `0xEE` 的地址提供了"逃生舱"机制
   - 开发者可以构造此类地址来绕过映射要求

   社区反馈：
   - 问题已被标记为功能增强请求
   - 开发者希望这类信息能够更好地暴露在 API 文档中
   - 需要改善相关机制的可发现性和文档说明

   这个讨论反映了智能合约平台在引入新机制时需要平衡安全性、功能性和易用性的挑战。虽然问题已通过 `0xEE` 逃生舱机制得到解决，但这一讨论为未来 API 设计和文档改进提供了重要参考。

### 2. XCM Pallet 延迟分阶段迁移机制优化提案

   Polkadot-SDK 团队提出了一项关于优化 XCM pallet 延迟分阶段迁移机制的重要提案 [Issue #8583](https://github.com/paritytech/polkadot-sdk/issues/8583)，旨在简化迁移触发机制并提高运行时升级的一致性。主要讨论点包括：

   - 当前依赖 `MigrateToLatestXcmVersion` 迁移需要手动添加到运行时的 Migrations 元组中
   - 并非所有运行时都包含此迁移，导致 XCM 版本更新不一致
   - 希望通过 pallet 的 `on_runtime_upgrade` 隐式触发，替代显式迁移配置
   - 与相关问题 [#3214](https://github.com/paritytech/polkadot-sdk/issues/3214) 和 [#7807](https://github.com/paritytech/polkadot-sdk/issues/7807) 形成系统性解决方案

   问题的根源：
   - `MigrateToLatestXcmVersion` 启动分阶段延迟迁移，然后通过 `on_idle` 处理
   - 需要运行时开发者手动配置迁移，容易遗漏或配置错误
   - 当前机制依赖外部触发，缺乏自动化和一致性保障
   - 不同运行时可能存在迁移状态不同步的问题

   技术优化方案：
   - **重构迁移函数**：将 `migrate_data_to_xcm_version` 重构为带有 `VersionMigrationStage` 的 `CurrentMigration` 阶段
   - **弃用显式迁移**：标记 `MigrateToLatestXcmVersion` 为弃用，逐步移除对其的依赖
   - **集成运行时升级**：利用 pallet 的 `on_runtime_upgrade` 钩子自动触发迁移过程
   - **MBM 集成研究**：调查是否适合使用 Multi-Block Migration (MBM) 重写 `CurrentMigration` 迁移

   实施计划：
   - **第一阶段**：重构现有迁移逻辑，实现 `VersionMigrationStage` 机制
   - **第二阶段**：修改 pallet 代码，在 `on_runtime_upgrade` 中集成迁移触发
   - **第三阶段**：标记 `MigrateToLatestXcmVersion` 为弃用，提供迁移指南
   - **第四阶段**：评估 MBM 集成可能性，考虑长期架构优化

   预期收益：
   - **简化配置**：运行时开发者无需手动配置 XCM 版本迁移
   - **提高一致性**：确保所有使用 XCM pallet 的运行时都能自动执行版本迁移
   - **降低维护成本**：减少因遗漏迁移配置导致的问题和支持工作
   - **增强可靠性**：通过自动化机制减少人为错误的可能性

   这个提案体现了 Polkadot 生态系统在简化开发者体验和提高系统可靠性方面的持续努力。通过将迁移逻辑内置到 pallet 中，不仅能够确保 XCM 版本更新的一致性，还为其他需要类似迁移机制的 pallet 提供了最佳实践参考。

### 3. 双重质押迁移完善方案讨论

   Polkadot-SDK 团队收到了一项关于完善双重质押（dual staking）迁移机制的重要提案 [Issue #8556](https://github.com/paritytech/polkadot-sdk/issues/8556)，重点解决当前迁移过程中的边缘情况和用户体验问题。主要讨论点包括：

   - 双重质押者无法在同时进行提名（nominating）时迁移其资金池账户，导致 UI 功能受限
   - Staking Dashboard 收到大量用户投诉，反映双重质押者因无法迁移而无法执行正常质押功能
   - 当前迁移方案未充分考虑双重质押边缘情况，缺乏将双重质押减少到零的明确路径
   - 需要从用户体验角度彻底解决这一问题，避免用户流失

   问题的根源：
   - 迁移设计时未充分考虑双重质押的复杂场景
   - 用户同时参与 solo staking 和 nomination pools，迁移逻辑存在冲突
   - 缺乏有效的"降级"机制帮助用户从双重质押状态退出
   - 链状态中存在这类边缘情况，影响系统整洁性

   社区提出的解决方案：
   - **扩展 permissionless 机制**：@rossbulat 提议更新 nomination pool pallet，扩展 permissionless unbond 和 withdraw 标准，覆盖双重质押账户
   - **清理链状态**：通过增强的 permissionless 机制整理链状态，移除双重质押边缘情况
   - **保持向前兼容**：确保解决方案不影响未来可能重新支持双重质押的计划

   官方回应和技术路径：
   - **现有解决方案**：@Ank4n 指出当前用户可以通过[从 solo staking 中提取所有质押](https://support.polkadot.network/support/solutions/articles/65000188140-changes-for-nomination-pool-members-and-opengov-participation#'NotMigrated'-error-message)，然后迁移 pool 账户来解决
   - **根本性修复**：升级 solo staking 使用 fungibles 机制，这是更彻底的解决方案
   - **版本规划**：相关修复已包含在 stable2503 SDK 发布中，等待 fellowship 运行时升级

   技术实现考量：
   - **短期方案**：扩展 permissionless unbond 机制，允许强制解除双重质押状态
   - **长期架构**：通过 fungibles 重构实现更优雅的双重质押支持
   - **迁移策略**：一旦运行时升级完成，可以移除当前过滤机制，重新启用双重质押
   - **向后兼容**：确保解决方案不破坏现有单一质押用户的体验

   用户体验影响：
   - **即时缓解**：为陷入迁移困境的用户提供明确的解决路径
   - **预防措施**：改善迁移前的用户沟通和提醒机制
   - **长期改善**：通过技术架构优化根本解决双重质押支持问题
   - **生态影响**：提升整体质押体验，维护用户对系统的信任

   这个讨论突显了在进行重大系统迁移时，充分考虑边缘情况和用户体验的重要性。虽然技术上可以通过手动操作解决现有问题，但从产品角度来看，提供自动化的解决方案更有利于用户留存和生态系统健康发展。这一案例为未来的系统升级提供了宝贵的经验教训。

### 4. 争议分发系统回退机制优化方案讨论

   Polkadot-SDK 团队围绕争议分发（dispute-distribution）系统的错误处理和回退机制展开了重要讨论 [Issue #8534](https://github.com/paritytech/polkadot-sdk/issues/8534)，重点关注如何防止错误情况下的消息洪泛攻击。主要讨论点包括：

   - 当争议接收者返回错误（如 AuthorityFlooding）时，发送者可能用消息淹没对方，使情况恶化
   - 需要为争议重发添加回退机制，避免在出现逻辑错误时造成网络压力
   - 与问题 [#8414](https://github.com/paritytech/polkadot-sdk/issues/8414) 和 [#8481](https://github.com/paritytech/polkadot-sdk/issues/8481) 相关，反映了系统性的鲁棒性挑战
   - 影响验证器性能和网络稳定性，需要在争议解决速度与系统保护之间找到平衡

   问题的技术根源：
   - 争议分发发送者在遇到错误时缺乏适当的回退机制
   - 旧的未确认争议在验证器重启后被重新提起，导致重复处理
   - 未升级节点与已升级节点之间的协议不兼容导致持续错误
   - 错误处理逻辑返回 `InvalidImport`，但未有效阻止重试

   实际影响案例：
   - **验证器性能下降**：@infrachris 报告其验证器在 AuthorityFlooding 期间从 A+ 降级为 A 评级
   - **系统资源消耗**：出现 `UnboundedChannelVeryLarge` 和 `NodeFlapping` 告警
   - **网络不稳定**：大量错误消息影响整体网络性能
   - **硬件资源浪费**：即使在高配置硬件上也出现性能问题

   技术解决方案讨论：
   - **发送端回退**：@alexggh 建议在 `sender/mod.rs` 中添加回退逻辑，在 `should_rate_limit` 条件下实施限流
   - **系统层面防护**：@eskimor 提出需要在 Substrate 层面处理垃圾消息，确保网络能够抵御少数恶意节点
   - **争议优先级平衡**：在快速解决争议的需求与系统保护机制之间寻找合理平衡
   - **根因分析**：关注争议导入失败的根本原因，而非仅处理症状

   版本兼容性问题：
   - **未升级节点影响**：分析显示大部分洪泛来自未升级到 v1.18.4 的验证器
   - **协议不匹配**：旧版本节点（如 v1.16.2、v1.17.3）与新版本存在争议处理差异
   - **修复传播**：PR [#8503](https://github.com/paritytech/polkadot-sdk/pull/8503) 的修复需要网络范围内的升级才能完全生效
   - **过渡期挑战**：在网络升级过程中需要处理混合版本环境的兼容性问题

   优化策略建议：
   - **智能回退算法**：实现基于错误类型和频率的动态回退机制
   - **网络层防护**：在连接层面实施公平连接处理，防止单个节点占用过多资源
   - **争议生命周期管理**：改进旧争议的处理逻辑，避免无效重试
   - **监控和告警**：增强对异常争议活动的监控和预警机制

   长期架构考量：
   - **系统弹性设计**：确保网络能够在部分节点异常时继续正常运行
   - **协议演进策略**：在协议升级时考虑向后兼容性和渐进式部署
   - **错误隔离机制**：防止局部错误影响整个网络的健康运行
   - **性能监控框架**：建立完善的性能监控体系，及时发现和处理异常

   这个讨论揭示了分布式网络系统在面对错误处理和版本升级时的复杂挑战。它强调了在设计网络协议时需要考虑故障模式和恶意行为的重要性，以及建立适当的防护机制来维护网络整体健康。这一案例为构建更加鲁棒的区块链网络基础设施提供了宝贵的实践经验。

### 5. Kademlia DHT 客户端/服务器模式启用方案讨论

   Polkadot-SDK 团队提出了一项关于启用 Kademlia DHT 客户端/服务器模式的网络优化提案 [Issue #8454](https://github.com/paritytech/polkadot-sdk/issues/8454)，旨在通过改进 DHT 路由表管理来提升网络发现和数据查询的可靠性。主要讨论点包括：

   - 通过避免将无法访问 p2p 端口的节点添加到路由表中来改善 DHT 网络健康状况
   - 提高 Kademlia DHT 查询执行时的节点可达性，增强记录发布和查找的可靠性
   - 由于 Polkadot 不使用 AutoNAT 协议，需要开发替代方案来检测节点的 p2p 端口可达性
   - 与 LiteP2P 项目的相关议题 [litep2p#387](https://github.com/paritytech/litep2p/issues/387) 形成协同解决方案

   问题的技术背景：
   - **路由表污染**：当前 DHT 实现可能将不可达节点加入路由表，降低查询成功率
   - **网络分割风险**：NAT 和防火墙导致部分节点无法提供有效的 DHT 服务
   - **查询效率低下**：查询请求发送到不可达节点时造成超时和重试，影响整体性能
   - **引导过程困难**：新节点加入网络时可能连接到无效的引导节点

   客户端/服务器模式的技术优势：
   - **角色分离**：明确区分能够为网络提供服务的节点（服务器）和仅消费服务的节点（客户端）
   - **路由表质量**：只有具备公网可达性的节点才参与路由表构建，提高查询成功率
   - **网络稳定性**：减少因连接失败导致的网络抖动和重连开销
   - **资源优化**：避免向不可达节点发送无效请求，节省网络带宽和计算资源

   实施挑战和技术考量：
   - **可达性检测**：需要开发可靠的机制来检测节点的公网可达性，替代 AutoNAT 协议
   - **动态状态管理**：节点的网络状态可能动态变化，需要支持角色的实时切换
   - **兼容性保证**：确保新机制与现有网络节点的向后兼容性
   - **误判处理**：设计容错机制，避免因误判导致有效节点被排除在外

   可达性检测策略：
   - **连接性测试**：通过尝试建立反向连接来验证节点的可达性
   - **端口探测**：使用专门的探测机制检查节点声明的端口是否实际可访问
   - **声誉系统**：基于历史连接成功率建立节点可达性信誉评分
   - **多重验证**：结合多种检测方法提高判断准确性

   预期性能改进：
   - **查询成功率提升**：通过确保路由表中节点的有效性，显著提高 DHT 查询成功率
   - **响应时间优化**：减少因连接不可达节点导致的超时，加快查询响应速度
   - **网络容量增强**：更高效的路由表利用率支持更大规模的网络部署
   - **引导过程改善**：新节点能够更快速、可靠地加入网络

   实施阶段规划：
   - **第一阶段**：开发可达性检测机制，在 LiteP2P 中实现基础功能
   - **第二阶段**：集成客户端/服务器模式到 Polkadot 节点，进行内部测试
   - **第三阶段**：在测试网络中部署，收集性能数据和稳定性反馈
   - **第四阶段**：根据测试结果优化，准备主网部署

   网络生态影响：
   - **节点运营优化**：为节点运营者提供明确的网络角色指导
   - **网络质量提升**：通过提高有效节点比例改善整体网络服务质量
   - **扩展性增强**：更可靠的 DHT 服务支持网络规模的进一步扩展
   - **开发者体验**：改善依赖 DHT 的应用和服务的性能表现

   这个提案体现了 Polkadot 网络基础设施的持续优化，通过引入更智能的网络拓扑管理来提升系统性能。客户端/服务器模式的引入不仅能够解决当前 DHT 网络面临的效率问题，还为未来更复杂的网络服务分层奠定了基础。这一优化将使 Polkadot 网络更加高效和可扩展。


## 技术生态和社区

### 1. PBA-X 第三期开启报名，深度探索 Web3 技术体系

   Polkadot Blockchain Academy 正式宣布 PBA-X（Polkadot Blockchain Academy eXplore）第三期课程开启报名 [报名公告](https://mp.weixin.qq.com/s/q6wsrrungLS_Y4ro5vFmjw)，这一由 Gavin Wood 创立的旗舰在线教育项目将于2025年6月23日正式开课。主要课程特点包括：

   - **系统化课程设计**：为期4周的密集学习，每周投入3-6小时，涵盖区块链基础原理到Polkadot架构的完整知识体系
   - **顶级师资阵容**：由Gavin Wood、Shawn Tabrizi、Kian Paimani等Parity核心团队成员亲自授课
   - **无门槛准入**：无需编程背景，采用英语授课配合字幕和辅助资料，社区提供中文支持
   - **灵活学习模式**：支持录播回看，兼顾系统性与学习灵活性
   - **实际应用导向**：每周测验、资料包下载、可选编程练习，学完即具备Substrate及Polkadot网络架构认知

   课程核心模块设计：
   - **密码学基础**：深入理解密钥生成、数字签名、Merkle树等核心安全结构，为Web3信任机制建立技术基础
   - **经济学原理**：学习供需逻辑、博弈论与市场机制，理解代币经济设计和去中心化激励机制
   - **区块链基础**：全面回顾从比特币到现代区块链的发展，重点讲解状态机、共识机制、P2P网络与智能合约
   - **治理机制**：深入剖析去中心化治理模型，重点介绍Polkadot的OpenGov系统和链上民主决策逻辑
   - **Substrate技术栈**：学习FRAME、XCM、WASM虚拟机、Scale Codec等核心技术组件
   - **Polkadot架构**：理解中继链、平行链、验证者与收集人职责，掌握跨链协作的实际应用场景

   报名信息与收益：
   - **开课时间**：2025年6月23日
   - **报名费用**：100美元（支持DOT支付）
   - **报名链接**：[https://polkadot-blockchain-academy.xyz/pba-x](https://polkadot-blockchain-academy.xyz/pba-x)
   - **证书认证**：获得PBA官方颁发的结业证书，被多个Web3项目视为加分项
   - **网络价值**：完课自动加入PBA校友网络，优秀者可获推荐参加PBA Campus面授课程

   全球影响力：
   前两期课程已吸引来自全球50多个国家的3000+位开发者、运营者、研究者、大学生与创业者参与，广受好评。成绩优异者将被推荐进入PBA Campus深造、PBA Fellowship项目，或获得Polkadot生态实习/工作机会推荐。

   这一课程项目体现了Polkadot生态系统对技术教育和人才培养的重视。通过提供系统化、高质量的区块链教育，PBA-X不仅为个人开发者提供了进入Web3领域的专业通道，也为整个Polkadot生态系统培育了更多具备深度技术理解的建设者。该项目的成功举办将进一步加强Polkadot在全球区块链教育领域的领导地位。

### 2. PolkaVM 架构突破：从 EVM 到 RISC-V 的技术革新

   Polkadot 生态系统迎来重要技术里程碑，新一代智能合约执行环境 PolkaVM 成功实现重大突破 [技术报告](https://mp.weixin.qq.com/s/1Bk4Q-s3yGzJeFF3FNHQFw)。Papermoon 团队近期成功将 Uniswap V2 完整部署到 PolkaVM 测试网，标志着这一基于 RISC-V 架构的虚拟机已具备承载复杂生产级应用的能力。主要技术成就包括：

   - **架构革新**：摒弃传统堆栈式执行模型，采用基于 RISC-V 的寄存器设计，实现底层执行逻辑的根本性重构
   - **兼容性保证**：在底层架构完全重写的同时，保持对 Solidity、Hardhat、Remix、MetaMask 等主流开发工具的完全兼容
   - **实际验证**：通过 Uniswap V2 这一逻辑复杂、模块交互密集的标准化 AMM 协议验证了系统的稳定性和可用性
   - **测试网部署**：已在 Westend 测试网成功上线，为主网部署奠定实践基础

   核心技术优势：
   - **执行效率提升**：基于 RISC-V 架构的寄存器模型更贴合现代硬件特性，显著提升执行性能
   - **资源计费优化**：实现更精细的资源计费机制，提供更透明和可预测的 Gas 成本结构
   - **多语言支持**：通过 LLVM 编译支持，为 Rust、C 等多种编程语言提供原生执行环境
   - **ZK 友好设计**：预留零知识证明友好结构，为未来隐私计算应用提供架构基础
   - **安全性增强**：支持形式化验证和自动化安全保障，提升合约系统整体安全水平

   开发者体验优化：
   PolkaVM 采用"底层革新、接口兼容"的设计策略，确保开发者可以在不改变现有工作流程的前提下享受新架构带来的性能提升。Uniswap V2 的成功部署证明了以下开发体验的连续性：
   - **无缝迁移**：现有 Solidity 合约可直接部署，无需代码修改
   - **工具链兼容**：Hardhat 部署脚本、Remix 开发环境、MetaMask 交互调试保持一致
   - **执行优化**：底层性能提升对开发者透明，自动享受架构红利

   技术意义与前瞻：
   - **架构演进**：代表从传统 EVM 路线向下一代执行架构的重要转型
   - **性能突破**：为处理更复杂的链上应用和更高的交易吞吐量提供技术基础
   - **生态扩展**：多语言支持将吸引更广泛的开发者群体参与 Polkadot 生态建设
   - **未来兼容**：为 Web3 应用向更复杂场景演进预留充足的架构空间

   产业影响：
   PolkaVM 的成功部署标志着区块链基础设施进入新的发展阶段。与大多数选择在 EVM 基础上增加优化层的方案不同，Polkadot 选择了从底层重新设计执行架构的路径。这种"向前兼容、向上突破"的技术策略，不仅保护了现有投资，也为未来创新奠定了更坚实的基础。

   Uniswap V2 作为 DeFi 领域最具代表性的复杂协议之一，其在 PolkaVM 上的成功运行证明了这一新架构已经跨越了从概念验证到生产可用的关键门槛。这一突破为 Polkadot 生态系统在下一代区块链基础设施竞争中确立了重要的技术优势，也为开发者提供了一个更强大、更灵活的智能合约执行平台。
   
### 3. Polkadot Hub 智能合约平台深度解析与技术路线

   Polkadot大使联盟计划推出了系列技术直播，第二期围绕Polkadot Hub智能合约平台进行了深度讨论 [技术讨论](https://mp.weixin.qq.com/s/cdn1r-t1nSSa6JZWZrEMog)。Parity Technologies核心团队成员详细阐述了Polkadot Hub的技术特色、开发策略和生态定位，为开发者提供了全面的技术指南。主要讨论内容包括：

   **平台定位与架构设计**：
   - **开发者平台定义**：Polkadot Hub被定位为快速开发和部署的主要平台，相比传统平行链模型提供更轻量化的解决方案
   - **渐进式扩展路径**：支持从智能合约到专属平行链的无缝迁移，实现"先小轿车后校车"的灵活发展模式
   - **原生功能集成**：提供质押、治理、身份系统和跨链桥等Polkadot原生功能的直接访问
   - **降低准入门槛**：解决平行链开发、部署和维护成本过高的问题，适合快速迭代和市场验证

   **智能合约技术优势**：
   - **性能突破**：目标实现500毫秒出块时间和30秒最终确认，相比以太坊7天确认期显著提升
   - **可靠性保障**：提供Reliability Dashboard实时监控平台性能，确保开发者部署信心
   - **深度集成特性**：通过XCM、质押、治理等预编译合约实现与Polkadot生态的无缝交互
   - **跨链通信能力**：突破传统"孤岛作战"限制，支持与所有平行链的直接通信

   **PolkaVM架构突破**：
   - **EVM兼容vs以太坊兼容**：在保持以太坊开发体验兼容的同时，通过PolkaVM实现更优执行性能
   - **JIT编译优势**：支持即时编译技术，相比传统EVM解释器显著提升执行速度
   - **链上DOOM演示**：成功在链上运行DOOM和Quake游戏，展示PolkaVM处理复杂计算任务的能力
   - **多语言支持**：除Solidity外，原生支持Rust、C、C++等通用编程语言，扩展开发者群体

   **开发者体验优化**：
   - **工具链兼容**：完全支持MetaMask、Foundry、Hardhat、Remix等以太坊生态成熟工具
   - **ink!语言延续**：继续支持Rust-based ink!智能合约，在pallet-revive上提供一级公民待遇
   - **渐进式部署**：无需学习新工具链，现有Solidity开发者可直接上手
   - **平滑迁移路径**：为JAM未来架构提供无缝过渡保障

   **生态扩展策略**：
   - **Solana VM支持探索**：技术上可行，但需要完整的生态系统集成支持，包括区块浏览器、支付API等配套服务
   - **基础设施合作**：计划与以太坊基础设施合作伙伴和DeFi项目联合首发，展示平台完整性
   - **性能持续优化**：长期目标实现Web2级别的用户体验，支持更复杂的链上应用场景

   **上线时间规划**：
   - **第一阶段（Q3初）**：以太坊兼容功能在Kusama上线，包括预编译模块和基础开发工具支持
   - **第二阶段（Q3初）**：XCM和原生资产访问权限开放，完善跨链交互能力
   - **主网部署（Q3中后期）**：将完整功能集部署到Polkadot主网，配合首发应用项目展示
   - **持续优化**：推出Reliability Dashboard，建立透明的性能监控和改进反馈机制

   **技术意义与前瞻**：
   这次深度讨论揭示了Polkadot在智能合约领域的差异化策略。通过PolkaVM的技术创新，Polkadot不仅实现了对以太坊开发者的友好兼容，更在性能、跨链能力和可扩展性方面建立了显著优势。特别是将链上运行复杂游戏作为技术展示，有力证明了平台处理高计算量任务的能力，为未来更复杂的链上应用奠定了基础。

   **生态影响评估**：
   Polkadot Hub的推出标志着生态系统策略的重要调整，通过提供更低门槛的入门路径来吸引更广泛的开发者群体。这种"智能合约+平行链"的分层架构不仅保护了现有投资，也为不同规模和需求的项目提供了合适的技术选择。同时，与JAM未来架构的兼容性设计确保了长期技术路线的连续性和投资保护。

### 4. W3F发布DV计划数据分析，探讨去中心化治理未来方向

   Web3基金会发布了对去中心化之声（Decentralized Voices，DV）计划的全面数据分析和反思报告 [治理分析](https://mp.weixin.qq.com/s/EBa5z46tu_vUA8Ji0Se8yg)，深入探讨了这一创新治理实验在过去一年中的表现、面临的挑战以及未来可能的发展方向。这一分析为Polkadot治理机制的演进提供了重要参考。

   **DV计划成就与数据分析**：
   - **委托规模与影响力**：约4200万DOT和18万KSM的投票权委托给社区不同DAO，赋予负责任的思考者真正影响治理决策的机会
   - **参与度表现**：六位DV代表在首月中非常活跃，对数十项公投进行深入讨论，进行数百次投票，投票风格各异但与社区整体意见基本一致
   - **决策影响分析**：约18.9%的公投结果会因DV投票而发生逆转，显示DV确实具有实质影响力，但不会轻易改变社区主流意见
   - **投票一致性**：在不到30次公投中才有一次出现DV大多数票与最终投票结果不同，体现了DV的最佳定位和核心影响力

   **治理质量提升效果**：
   - **审查机制强化**：国库提案受到更严格审查，支出变得更加审慎，更多提案被推向结构化赏金形式
   - **问责文化建立**：代表们提出尖锐问题关于资助价值、紧急性、交付结果和衡量标准，带来纪律性的传染效应
   - **新生力量激发**：围绕治理新成立众多DAO，包括东欧、中国和拉美等地区本地组织，原本非治理人士开始积极参与
   - **文化影响力扩散**：重新分配了可能性，让人们看到站出来、组织起来并展现思考力就能赢得一席之地

   **浮现的问题与挑战**：
   - **影响力打包问题**：部分社区成员通过加入多个可委托DAO放大影响力，在不同小组中多次投票，与DV初衷背道而驰
   - **问责机制缺失**：DV代表使用W3F的DOT投票而非自己的资产，缺乏自动惩罚机制，不负责任投票没有明确后果
   - **利益冲突处理**：要求代表解释投票理由并在利益冲突时弃权，但这些做法未被正式规定，缺乏明确规则和惩罚机制
   - **新精英阶层风险**：担心DV创造了另一个由多个DAO"大户"组成的精英阶层，实际上未真正解决中心化问题

   **治理哲学思辨**：
   - **直接民主vs信任委托**：DV试图在每位代币持有者直接参与投票与委托活跃人士代为行使投票权之间找到平衡
   - **权力与层级的矛盾**：探讨是否可能在赋予权力的同时不制造层级，在放大社区声音与避免统治集团之间走钢丝
   - **治理指导价值**：DV作为治理指导、文化投资和"降落伞"，帮助仍在学习的治理体系平稳着陆
   - **实验意义反思**：搅动水面让社区不得不提出尚未准备好回答的治理根本性问题

   **三大未来方案探讨**：

   **方案A - 终止计划**：
   - 在当前批次DV结束后正式终止DV计划
   - 承认DV虽有积极效果但结构性缺陷已超过收益
   - 回归纯粹的代币持有者投票系统
   - 基金会可继续参与治理但不再有专门社区代表

   **方案B - 扩展与分散**：
   - 增加DV代表数量（从6增加到10或更多）
   - 每位代表持有更少投票权（每位1-2百万DOT而非7百万）
   - 优先考虑多样化代表涵盖更多地区和关注领域
   - 通过更多声音和更分散权力实现更广泛影响

   **方案C - 改革共创DV 2.0**：
   - 引入社区提名或选举代表与任命代表并存
   - 设置任期限制或定期轮换防止小群体垄断权力
   - 正式化利益冲突规则，强制公开声明和明确弃权要求
   - 要求代表质押DOT作为利益捆绑，创建导师体系培养新代表

   **社区决策流程**：
   - **反馈收集阶段**：收集社区对三大方案的意见和建议，欢迎混合方案或全新思路
   - **WFC公投设计**：根据反馈在OpenGov提出不具约束力的"WFC"公投评估社区态度
   - **批判性审视**：鼓励社区指出思路盲点，提出改进建议或完全不同的道路
   - **共创下一章**：借助社区多样性共同设计去中心化之声的未来形态

   **治理实验意义**：
   DV计划作为"通过中心化实现去中心化"的治理实验，在过去一年中既取得了显著成就，也暴露了深层次的治理哲学问题。其成功激发了新的治理参与者和文化，但也引发了关于权力分配、问责机制和去中心化本质的根本性思考。

   **生态发展影响**：
   这一治理实验的反思和改进对整个Polkadot生态系统具有重要意义。它不仅关乎投票机制的技术层面优化，更触及了去中心化组织如何在保持民主参与的同时实现有效治理的核心挑战。无论最终选择哪种方案，这一过程本身都展现了Polkadot社区在治理创新方面的开放态度和持续探索精神。

   **前瞻性思考**：
   DV计划的经验为其他区块链项目的治理设计提供了宝贵参考。它证明了社区驱动的治理实验不仅是可能的，而且是必要的。通过数据驱动的分析和开放的社区讨论，Polkadot正在为去中心化治理的未来发展奠定实践基础。

### 5. Polkadot 2025 Q1国库报告：支出趋于理性，首次实现正收益

   Polkadot发布了2025年第一季度国库报告 [财务报告](https://mp.weixin.qq.com/s/3pdO-ZxMIuCNRM3DZp57nQ)，这份详尽的财务分析展现了Polkadot DAO在资产管理、支出控制和治理透明度方面的重要进展。报告显示，本季度国库首次实现净正收益，标志着Polkadot财务状况的重要里程碑。

   **资产负债表现状**：
   - **总资产规模**：当前国库资产约1.35亿美元（3350万DOT），扣除负债后盈余3260万DOT（1.31亿美元）
   - **可自由支配资金**：1.02亿美元（2530万DOT），其中600万美元为稳定币现金储备，290万DOT用于自动稳定币兑换
   - **战略预留资金**：2500万美元（62万DOT）专门用于市场营销、DeFi工具、游戏、商务拓展等战略计划
   - **DeFi部署资金**：780万美元（190万DOT）活跃部署于各类DeFi市场运作中
   - **储备时长**：拥有长达10年的储备资金，得益于调整后的通胀模型，长期财务状况更加稳健

   **首次净正收益里程碑**：
   - **季度支出**：共支出1860万美元（390万DOT），在未考虑通胀销毁的情况下运营亏损380万DOT
   - **净利润实现**：计入通胀与销毁后，净利润80,000DOT，创造国库首次净正收益记录
   - **支出结构优化**：支出最多的三个类别为生态推广750万美元、开发560万美元、运营210万美元
   - **部门化管理**：约30%（560万美元）支出通过赏金任务与集体部门完成，提升治理效率

   **资产配置多元化策略**：
   - **稳定币管理**：590万美元稳定币已完成兑换，1190万美元稳定币已用于支出，第三轮280万美元/月兑换计划已获批
   - **DeFi流动性投资**：770万美元资金注入4个不同DeFi协议提供流动性，实现资产增值
   - **跨链资产部署**：15%资产部署至平行链DeFi生态，包括Hydration（1690万美元）、Centrifuge（150万美元）等
   - **非托管流动性**：100万DOT注入Hydration Omnipool作为流动性提供，应收贷款92.3万DOT用于RWA收益池等

   **支出分类详细分析**：

   **生态推广（750万美元）**：
   - **市场营销**：550万美元，包括与Brave浏览器300万美元合作、公关支出87万美元、内容制作52万美元
   - **活动举办**：150万美元，涵盖130万美元会议参与、45万美元Bash系列活动、74场全球meetup活动
   - **大使项目**：41万美元支持全球大使计划和社区代理人发展

   **技术开发（550万美元）**：
   - **数据服务与索引**：Token Terminal 100万美元、Giant Squid 17万美元
   - **跨链桥开发**：Snowbridge持续支付120万美元
   - **钱包生态**：NovaWallet 100万美元、账户抽象Interstellar 60万美元
   - **核心协议**：Polkadot-API 66万美元、Fellowship技术成员薪资29万美元

   **运维基础设施（210万美元）**：
   - **RPC服务**：89万美元确保网络访问稳定性
   - **区块浏览器**：76万美元支持Polkassembly（53万）、Subscan（16万）等平台
   - **数据服务**：SQD 26万美元、测试网Paseo 11万美元

   **商务拓展（190万美元）**：
   - **游戏板块**：80万美元，包括游戏赏金50万美元、Blockdeep服务30万美元
   - **隐私安全**：Peer3点对点SDK 35万美元、Ideal Network随机数信标30万美元、安全审计22万美元
   - **DeFi集成**：18万美元推动垂直领域应用落地

   **部门化治理成效**：
   - **赏金机制**：530万美元（28%总支出），包括市场营销赏金220万、活动赏金95万、基础设施建设72万等
   - **技术集体**：季度薪资支出29万美元，子金库首次支出3.8万美元
   - **专业化发展**：各领域专家组成的专属部门围绕关键职能形成，提升治理效率和专业性

   **稳定币策略成果**：
   - **历史累计**：自2024年3月以来累计兑换1600万USDC和1600万USDT，平均每月流入240万美元
   - **支出同步**：向提案人支付1400万USDC和1200万USDT，150万美元投入Centrifuge RWA收益池
   - **未来规划**：第三轮兑换计划将带来每月280万美元稳定币流入，增强财务稳定性

   **财务管理创新**：
   - **会计标准**：遵循会计领域最佳实践，在Web3领域开创先河，提供完整资产负债表和损益表
   - **透明度提升**：详细披露所有活跃账户和资产分布，细化支出类别和用途说明
   - **风险管理**：通过多元化资产配置降低DOT价格波动风险，同时保持充足流动性
   - **生态回流**：将闲置资金回流至Polkadot生态系统，既支持生态发展又实现资产增值

   **治理演进意义**：
   这份报告体现了Polkadot DAO治理体系的成熟化发展。从首次实现净正收益到支出结构的理性化，从专业化部门的建立到transparent财务管理实践，Polkadot正在建立一个可持续、透明且高效的去中心化组织运营模式。

   **生态发展影响**：
   国库的专业化管理不仅确保了Polkadot网络的长期可持续发展，更为整个Web3行业的DAO治理提供了最佳实践范例。通过将资金有序投入基础设施、生态推广、技术开发等关键领域，Polkadot正在构建一个完整的Web3服务堆栈，为开发者和用户提供低成本、高性能的区块链解决方案。

   **前瞻性意义**：
   随着通胀模型调整和财务管理的持续优化，Polkadot国库展现出强劲的财务健康状况。10年储备期的安全边际、多元化的资产配置策略以及专业化的治理机制，为Polkadot在激烈的区块链竞争中保持长期优势奠定了坚实基础。这种可持续的财务模式也为其他区块链项目的国库管理提供了重要参考。


## 跨链协议

### 1. Cumulus Aura 等值检查机制优化

   Polkadot-SDK团队对 Cumulus Aura 共识中的等值检查机制进行了重要改进 [PR #8669](https://github.com/paritytech/polkadot-sdk/pull/8669)。这次更新显著增强了平行链共识的安全性和可靠性。主要更新包括：

   - 改进了等值检查逻辑，不仅检查槽位，还考虑区块号和中继父块信息
   - 确保系统能够正常处理每个槽位构建多个区块的场景
   - 保障了从可用性恢复中导入区块的能力，防止网络在等值风暴中停滞
   - 为后续的链上等值削减和违规作者禁用功能奠定基础
   - 向后移植到多个稳定版本，确保广泛的兼容性覆盖

   这次更新的技术细节包括：
   - 重构了等值导入队列的检查机制，采用更全面的验证标准
   - 在等值检测中综合考虑槽位、区块号和中继父块的组合唯一性
   - 优化了区块导入流程，确保合法的可用性恢复区块能够正常导入
   - 提高了等值检测的精确度，减少了误报和漏报情况
   - 增强了网络在面对恶意行为时的抗攻击能力

   这一功能的实现对Polkadot生态系统有重要意义：
   - 大幅提升了平行链共识的安全性和可靠性
   - 防止了等值攻击导致的网络停滞问题
   - 为实现更完善的链上治理和惩罚机制创造了条件
   - 改善了平行链在异常情况下的恢复能力
   - 增强了整个网络对恶意行为的防护水平

   值得注意的是，这次改进将等值检查的限制设置为16个，在新的检查机制下这是一个非常宽松的限制。下一步的发展方向包括实现链上等值削减机制和自动禁用违规作者功能，这将进一步完善Polkadot网络的安全防护体系。

### 2. 验证上下文中数据结构性能优化

   Polkadot-SDK团队在验证上下文中实施了重要的性能优化，通过使用 hashbrown HashMap/HashSet 替换 BTreeMap/BTreeSet 来显著提升验证效率 [PR #8606](https://github.com/paritytech/polkadot-sdk/pull/8606)。这次更新大幅改善了区块验证的性能表现。主要更新包括：

   - 在 TrieCache 和 TrieRecorder 中采用 hashbrown HashMap/HashSet 替代 BTreeMap/BTreeSet
   - 同步升级 memory-db 依赖以支持新的数据结构
   - 实现读取操作性能提升约40%，写入操作性能改善约20%
   - 基于性能分析数据驱动的优化决策，解决了验证过程中的性能瓶颈
   - 确保在加密安全前提下的性能优化实施

   这次更新的技术细节包括：
   - 识别并解决了验证过程中数据插入和检索的性能瓶颈
   - 利用键值通过加密哈希函数派生的特性，安全地使用哈希表结构
   - 优化了 Trie 缓存机制的底层实现，减少了查找和插入的时间复杂度
   - 通过基准测试验证了性能改进的有效性
   - 保持了与现有API的完全兼容性，确保无缝升级

   这一功能的实现对Polkadot生态系统有重要意义：
   - 显著提升了平行链区块验证的效率和吞吐量
   - 降低了验证者节点的计算资源消耗
   - 改善了网络整体的响应性能和用户体验
   - 为处理更高交易量和更复杂的平行链逻辑提供了基础
   - 展示了数据驱动的性能优化方法在区块链系统中的有效性

   值得注意的是，这次优化基于深度性能分析的发现，证明了在验证上下文中数据结构选择对整体性能的关键影响。由于键值已通过加密哈希函数处理，使用哈希表是安全的，避免了潜在的哈希碰撞攻击。这种优化方法为后续的性能改进工作提供了重要参考。

### 3. Cumulus 整理器区块宣布协议修复

   Polkadot-SDK团队修复了 Cumulus 整理器在最小中继链环境下的关键通信问题，确保区块宣布协议能够在后台正常运行 [PR #8514](https://github.com/paritytech/polkadot-sdk/pull/8514)。这次修复解决了整理器无法正常宣传区块的严重问题。主要更新包括：

   - 修复了 `/block-announces/1` 协议在 litep2p 网络后端下的处理问题
   - 解决了通知服务句柄被过早丢弃导致的协议终止问题
   - 消除了 libp2p 和 litep2p 在协议处理方式上的差异影响
   - 恢复了整理器与验证者之间的正常通信能力
   - 显著降低了 CPU 使用率，从7.5%优化到1.87%

   这次更新的技术细节包括：
   - 识别并修复了 litep2p 后端长期运行任务的异常终止问题
   - 确保区块宣布协议的通知服务句柄得到正确维护
   - 解决了全节点与最小中继链节点之间的协议协商失败问题
   - 修复了因协议中断导致的节点断连和禁止问题
   - 恢复了权威发现和验证者连接的正常功能

   这一功能的实现对Polkadot生态系统有重要意义：
   - 恢复了平行链整理器的正常运行能力
   - 确保了整理器与验证者网络之间的稳定通信
   - 解决了可能导致平行链出块中断的关键问题
   - 提高了网络的整体稳定性和可靠性
   - 为平行链的正常运营提供了重要保障

   值得注意的是，这个问题源于 libp2p 和 litep2p 在协议处理方式上的细微差异。libp2p 会在没有相应句柄的情况下继续在后台操作协议，而 litep2p 则会终止相关任务。修复确保了两种网络后端的行为一致性，并已向后移植到多个稳定版本，确保生产环境的稳定运行。

### 4. BEEFY 等值削减比例安全性调整

   Polkadot-SDK团队对 BEEFY（Bridge Efficiency Enabling Finality Yielder）协议的等值削减机制进行了重要的安全性调整，基于最新的学术研究优化削减比例设置 [PR #8427](https://github.com/paritytech/polkadot-sdk/pull/8427)。这次更新强化了BEEFY网桥协议的安全保障。主要更新包括：

   - 将分叉投票（fork voting）的削减比例调整为50%，提高对恶意分叉行为的威慑力
   - 将未来区块投票（future block voting）的削减比例同样设为50%，防范时间线攻击
   - 基于学术论文 [eprint.iacr.org/2025/057.pdf](https://eprint.iacr.org/2025/057.pdf) 的安全性分析结果
   - 保持双重投票证明的现有处理公式，考虑意外或非恶意双重投票的风险
   - 向后移植到多个稳定版本（stable2412、stable2503），确保生产网络安全

   这次更新的技术细节包括：
   - 重新评估了不同类型等值行为的威胁级别和相应的经济惩罚机制
   - 区分恶意攻击行为与可能的操作失误，采用差异化的削减策略
   - 基于密码学安全分析调整削减参数，确保经济激励的有效性
   - 保持与现有BEEFY协议实现的完全兼容性
   - 经过安全审计确认参数调整的合理性和安全性

   这一功能的实现对Polkadot生态系统有重要意义：
   - 显著增强了BEEFY跨链桥协议的安全防护水平
   - 提高了对潜在攻击者的经济威慑效果
   - 优化了激励机制，更好地平衡安全性与操作容错性
   - 为BEEFY协议在更大规模应用中的部署提供了坚实基础
   - 展示了学术研究与实际协议安全参数调优的有效结合

   值得注意的是，这次调整基于深入的安全性分析和建模，确保了削减比例既能有效威慑恶意行为，又不会对诚实但可能出现操作失误的参与者造成过度惩罚。50%的削减比例在分叉投票和未来区块投票场景下能够有效防范各种已知的攻击向量，同时为双重投票保留了更宽松的处理机制，体现了协议设计的精细化和人性化考量。

### 5. XCM 小额存款错误处理机制优化

   Polkadot-SDK团队对 XCM 执行器的资产存款处理机制进行了重要改进，优化了小额存款（dust deposits）的错误处理逻辑 [PR #8351](https://github.com/paritytech/polkadot-sdk/pull/8351)。这次更新显著提升了复杂跨链资产转移的成功率和用户体验。主要更新包括：

   - 增强了 `deposit_assets_with_retry` 功能，将低于存在存款（existential deposit）的小额资产处理改为非致命错误
   - 实现了智能的小额资产销毁机制，当遇到 `TokenError::BelowMinimum` 时自动销毁无法存入的dust并继续处理其他资产
   - 解决了复杂XCM程序在多资产转移时因剩余手续费资产变成dust而整体失败的问题
   - 修复了长期存在的问题 [#4408](https://github.com/paritytech/polkadot-sdk/issues/4408)，提升了XCM执行的鲁棒性
   - 向后移植到stable2503版本，确保生产网络立即受益于改进

   这次更新的技术细节包括：
   - 重构了批量资产存款的错误处理逻辑，区分致命错误与可忽略的小额存款错误
   - 实现了精确的dust检测和销毁机制，确保不会因为微小余额影响整个交易执行
   - 优化了资产存款重试策略，提高了复杂跨链操作的成功率
   - 保持了与现有运行时API的完全兼容性，现有平行链和中继链集成自动受益
   - 不需要任何迁移步骤或弃用处理，实现无缝升级

   这一功能的实现对Polkadot生态系统有重要意义：
   - 显著提高了涉及多资产转移的复杂XCM程序的执行成功率
   - 改善了用户在跨链资产操作中的体验，减少了因技术细节导致的交易失败
   - 增强了XCM执行器的容错能力，使其能够更好地处理边界情况
   - 为更复杂的跨链金融应用奠定了基础，支持更多样化的资产操作场景
   - 展示了Polkadot团队在持续优化用户体验方面的努力

   值得注意的是，这次改进采用了保守且安全的设计策略。只有在确认为BelowMinimum错误时才会销毁dust资产，其他类型的存款错误仍然会导致整个批次失败，确保了系统的安全性。这种精细化的错误处理机制体现了XCM协议在实用性和安全性之间的精确平衡，为跨链资产互操作性的进一步发展提供了重要基础。

### 6. Snowbridge 资产位置检查兼容性优化

   Polkadot-SDK团队对 Snowbridge 以太坊桥的资产处理机制进行了重要的兼容性优化，移除了不必要的资产位置检查以提升跨版本XCM兼容性 [PR #8473](https://github.com/paritytech/polkadot-sdk/pull/8473)。这次更新简化了代码逻辑并增强了桥接协议的健壮性。主要更新包括：

   - 移除了出站队列转换器中的冗余资产ID验证逻辑，简化了资产处理流程
   - 利用 `TokenIdOf` 转换的XCM版本无关特性，确保V4和V5版本的XCM资产都能得到一致的token ID
   - 优化了资产注册验证机制，仅通过 `ConvertAssetId::convert(&token_id)` 即可充分验证token的注册状态
   - 消除了可能导致兼容性问题的额外检查步骤，提高了桥接操作的成功率
   - 向后移植到stable2503版本，确保生产环境桥接稳定性

   这次更新的技术细节包括：
   - 识别并移除了 `ensure!(asset_id == expected_asset_id, InvalidAsset)` 的冗余检查
   - 保持了资产注册验证的核心功能，确保只有已注册的token能够通过桥接
   - 简化了代码路径，减少了潜在的故障点和维护复杂度
   - 确保了Snowbridge对不同XCM版本资产的一致处理能力
   - 经过完整的测试验证，确保简化后的逻辑不会影响安全性

   这一功能的实现对Polkadot生态系统有重要意义：
   - 提升了Snowbridge以太坊桥的跨版本兼容性和可靠性
   - 简化了桥接协议的维护工作，降低了潜在的技术债务
   - 增强了以太坊与Polkadot生态系统之间的资产互操作性
   - 为未来XCM版本升级提供了更好的前向兼容性保障
   - 展示了在保持安全性前提下的代码优化最佳实践

   值得注意的是，这次优化基于对 `TokenIdOf` 转换机制的深入理解。虽然理论上不同XCM版本可能会因为 `NetworkId` 枚举变体的差异产生不同的token ID，但在实践中，这种转换机制能够为V4和V5版本的资产提供一致的标识。移除额外检查不仅简化了代码，还消除了可能的误报情况，为跨链资产桥接提供了更流畅的用户体验。

